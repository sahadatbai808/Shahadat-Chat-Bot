const schedule = require('node-schedule');
const moment = require('moment-timezone');
const chalk = require('chalk');

module.exports.config = {
    name: 'autosent',
    version: '10.0.0',
    hasPermssion: 0,
    credits: "ğ’ğ¡ğšğ¡ğšğğšğ­ ğˆğ¬ğ¥ğšğ¦",
    description: 'Automatically sends scheduled messages in groups',
    commandCategory: 'group messenger',
    usages: '[]',
    cooldowns: 3
};

const messages = [
    { time: '12:00 AM', message: 'à¦…à¦¨à§‡à¦• à¦°à¦¾à¦¤ à¦¹à¦²à§‹, à¦˜à§à¦®à¦¿à¦¯à¦¼à§‡ à¦ªà¦¡à¦¼ Bby Good Night ğŸ˜´ğŸ’¤â¤ï¸' },
    { time: '01:00 AM', message: 'à¦•à¦¿à¦°à§‡ à¦¤à§à¦‡ à¦à¦–à¦¨à§‹ à¦˜à§à¦®à¦¾à¦¸ à¦¨à¦¾à¦‡? à¦¤à¦¾à§œà¦¾à¦¤à¦¾à§œà¦¿ à¦˜à§à¦®à¦¿à§Ÿà§‡ à¦ªà§œ!ğŸ˜¾ğŸ˜´ğŸ›Œ' },
    { time: '02:00 AM', message: 'à¦˜à§à¦®à§‡ à¦†à§Ÿ à¦­à¦¾à¦‡! à¦à¦–à¦¨à§‹ à¦œà¦¾à¦‡à¦—à¦¾ à¦†à¦«à¦¸à§‹à¦¸ à¦•à§à¦¯à¦¾à¦¨?ğŸ˜¤ğŸ‘ŠğŸ’¤' },
    { time: '03:00 AM', message: 'à¦¸à¦¬à¦¾à¦‡ à¦˜à§à¦®à¦¾à¦‡à§Ÿà¦¾ à¦—à§‡à¦›à§‡, à¦¤à§à¦‡ à¦à¦–à¦¨ à¦œà¦¾à¦‡à¦—à¦¾ à¦†à¦¸à§‹à¦¸ à¦•à§à¦¯à¦¾à¦¨?ğŸ™„ğŸŒƒğŸ›Œ' },
    { time: '04:00 AM', message: 'à¦à¦•à¦Ÿà§ à¦ªà¦° à¦†à¦œà¦¾à¦¨ à¦¹à¦¬à§‡, à¦¸à¦®à§Ÿ à¦¹à§Ÿà§‡ à¦—à§‡à¦›à§‡à¥¤ ğŸ•ŒğŸ•‹ğŸ•“' },
    { time: '05:00 AM', message: 'à¦«à¦œà¦°à§‡à¦° à¦†à¦œà¦¾à¦¨ à¦¹à§Ÿà§‡ à¦—à§‡à¦›à§‡, à¦¨à¦¾à¦®à¦¾à¦œà¦Ÿà¦¾ à¦ªà¦°à§‡ à¦¨à¦¿à¦“ à¦ªà¦¿à¦“~ ğŸ•Œâœ¨ğŸ¤²ğŸ’–' },
    { time: '06:00 AM', message: 'à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§à¦¯à¦¼à¦¾à¦²à¦¾à¦‡à¦•à§à¦® Good Morning Bby! à¦à¦¤à§‹ à¦¸à¦•à¦¾à¦²à§‡ à¦˜à§à¦® à¦¥à§‡à¦•à§‡ à¦‰à¦ à§‡ à¦ªà§œà¦›? ğŸŒ…ğŸ’–ğŸ˜³' },
    { time: '07:00 AM', message: 'à¦˜à§à¦® à¦­à¦¾à¦™à¦¤à§‡à¦‡ à¦®à§‹à¦¬à¦¾à¦‡à¦²! à¦¦à¦¾à¦à¦¤ à¦¬à§à¦°à¦¾à¦¶à¦Ÿà¦¾ à¦•à¦°à¦¬à¦¿ à¦¤à§‹ à¦¨à¦¾à¦•à¦¿!ğŸ›Œâ¡ï¸ğŸ“±' },
    { time: '08:00 AM', message: 'à¦ªà¦¿à¦“, à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦°à§‡à¦–à§‡ à¦¦à¦¾à¦à¦¤ à¦¬à§à¦°à¦¾à¦¶ à¦•à¦°à§‡ à¦–à§‡à§Ÿà§‡ à¦¨à¦¾à¦“!ğŸ“±ğŸª¥ğŸ½ï¸' },
    { time: '09:00 AM', message: 'Bby, Breakfast korco?ğŸ³ğŸ¥ğŸ’–' },
    { time: '10:00 AM', message: 'à¦•à¦¿à¦°à§‡ à¦­à¦¨à§à¦¡, à¦¤à§à¦‡ à¦†à¦œ à¦•à¦²à§‡à¦œ à¦¯à¦¾à¦¸ à¦¨à¦¾à¦‡? ğŸ˜œğŸ“šğŸ™„' },
    { time: '11:00 AM', message: 'à¦¨à¦¾à¦Ÿà¦• à¦•à¦® à¦•à¦° à¦ªà¦¿à¦“~ à¦¬à¦¸ à¦à¦–à¦¨ à¦¬à¦¿à¦œà¦¿ à¦†à¦›à§‡!ğŸ™„ğŸ“±ğŸ’¼' },
    { time: '12:00 PM', message: 'Good Afternoon! ğŸŒğŸ™ŒğŸŒ¸' },
    { time: '01:00 PM', message: 'à¦­à¦¨à§à¦¡ à¦•à§‹à¦¥à¦¾à¦•à¦¾à¦°, à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦°à¦¾à¦–! à¦—à§‹à¦¸à¦² à¦•à¦°à§‡ à¦–à¦¾à¦“à§Ÿà¦¾-à¦¦à¦¾à¦“à§Ÿà¦¾ à¦•à¦°à§‡ à¦¨à§‡ğŸ”ªğŸ›ğŸ½ï¸' },
    { time: '02:00 PM', message: 'Jan, à¦¤à§‹à¦®à¦¾à¦•à§‡ à¦›à¦¾à¦¡à¦¼à¦¾ à¦†à¦° à¦¦à§à¦ªà§à¦°à§‡ à¦˜à§à¦® à¦¹à¦¯à¦¼ à¦¨à¦¾â€¦.!ğŸ˜´ğŸ’”ğŸŒ™' },
    { time: '03:00 PM', message: 'à¦…à¦¨à§‡à¦• à¦—à¦°à¦® à¦ªà¦¡à¦¼à¦›à§‡ à¦†à¦œ! ğŸ¥µğŸŒğŸ’¦' },
    { time: '04:00 PM', message: 'à¦ªà¦°à¦¿à¦¸à§à¦¥à¦¿à¦¤à¦¿ à¦¯à§‡à¦®à¦¨à¦¿ à¦¹à§‹à¦• à¦¨à¦¾ à¦•à§‡à¦¨, à¦¸à¦¬ à¦¸à¦®à§Ÿ à¦¹à¦¾à¦¸à¦¤à§‡à¦‡ à¦¹à¦¬à§‡! ğŸ˜…ğŸ•’ğŸ™‚' },
    { time: '05:00 PM', message: 'Good Evening Everyone! à¦¸à¦¬à¦¾à¦‡ à¦¹à¦¾à¦¤ à¦®à§à¦– à¦§à§à¦¯à¦¼à§‡ à¦¨à¦¾à¦“! ğŸŒ†ğŸ‘ğŸ’¦' },
    { time: '06:00 PM', message: 'à¦•à¦¿à¦°à§‡ à¦­à¦¨à§à¦¡, à¦¤à§à¦‡ à¦†à¦œ à¦ªà¦¡à¦¼à¦¤à§‡ à¦¬à¦¸à¦›à¦¿à¦²à¦¿ à¦¨à¦¾à¦•à¦¿?ğŸ˜ğŸ“šğŸ¤”' },
    { time: '07:00 PM', message: 'à¦†à¦®à¦¾à¦° cute bby à¦Ÿà¦¾à¦¹ à¦–à¦¾à¦¨à¦¾ à¦–à¦¾à¦‡à¦›à§‡...!ğŸ˜˜ğŸ½ï¸â¤ï¸' },
    { time: '08:00 PM', message: 'à¦“à¦‡ à¦“à¦‡, à¦à¦¤à§‹ bot bot à¦¨à¦¾ à¦•à¦°à§‡ à¦†à¦®à¦¾à¦° à¦¬à¦¸ à¦¶à¦¾à¦¹à¦¾à¦¦à¦¾à§ à¦•à§‡ à¦à¦•à¦Ÿà¦¾ à¦—à¦« à¦¦à§‡...!ğŸ«°ğŸ˜ğŸ”¥' },
    { time: '09:00 PM', message: 'à¦•à¦¿à¦°à§‡ à¦­à¦¨à§à¦¡, à¦–à¦¾à¦‡à¦¬à¦¿ à¦•à¦–à¦¨? à¦¸à¦¾à¦°à¦¾à¦¦à¦¿à¦¨ à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦Ÿà¦¿à¦ªà¦¸..!ğŸ˜œğŸ“±ğŸ˜¾' },
    { time: '10:00 PM', message: 'à¦¯à§‡ à¦›à§‡à§œà§‡ à¦—à§‡à¦›à§‡ ğŸ˜” à¦¤à¦¾à¦•à§‡ à¦­à§à¦²à§‡ à¦¯à¦¾à¦“ ğŸ™‚ à¦†à¦®à¦¾à¦° à¦¬à¦¸ à¦¶à¦¾à¦¹à¦¾à¦¦à¦¾à§ à¦à¦° à¦¸à¦¾à¦¥à§‡ à¦ªà§à¦°à§‡à¦® à¦•à¦°à§‡ à¦¤à¦¾à¦•à§‡ à¦¦à§‡à¦–à¦¿à§Ÿà§‡ à¦¦à¦¾à¦“...!ğŸ™ˆğŸ¸ğŸ¤—' },
    { time: '11:00 PM', message: 'à¦¨à¦¾à¦Ÿà¦• à¦•à¦® à¦•à¦° à¦ªà¦¿à¦“~ à¦¬à¦¸ à¦à¦–à¦¨ à¦¬à¦¿à¦œà¦¿ à¦†à¦›à§‡!ğŸ™„ğŸ“±ğŸ’¼' }
];

const createMessageBox = (time, message) => {
    return `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n` +
           `\tğğ¨ğ° ğ¢ğ­ğ¬ ğ­ğ¢ğ¦ğ ${time} â³\n\n` +
           `${message}\n` +
           `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n` +
           `\tâ«· ğğ¨ğ­ ğğ°ğ§ğğ«: ğ’ğ¡ğšğ¡ğšğğšğ­ â«¸\n` +
           `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`;
};

module.exports.onLoad = ({ api }) => {
    console.log(chalk.bold.hex("#00c300")("============ SUCCESFULLY LOADED THE AUTOSENT COMMAND ============"));

    messages.forEach(({ time, message }) => {
        const [rawHour, minutePeriod] = time.split(":");
        const [minute, period] = minutePeriod.split(" ");
        let hour = parseInt(rawHour, 10);
        const minuteNum = parseInt(minute, 10);

        // Convert to 24-hour format
        if (period === 'AM' && hour === 12) hour = 0;
        if (period === 'PM' && hour !== 12) hour += 12;

        // Schedule the message
        schedule.scheduleJob({ hour, minute: minuteNum, tz: "Asia/Dhaka" }, () => {
            const fullMessage = createMessageBox(time, message);
            api.getThreadList(25, null, ["INBOX"], (err, list) => {
                if (err) return console.error("Thread list error:", err);
                list.forEach(thread => {
                    api.sendMessage(fullMessage, thread.threadID);
                });
            });
        });
    });
};
